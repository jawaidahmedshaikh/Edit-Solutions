<?xml version="1.0" encoding="utf-8"?>
<mx:Canvas 
	xmlns:mx="http://www.adobe.com/2006/mxml" 
	width="100%" height="100%" 
	xmlns:custom="com.segsoftware.view.custom.*"
	show="conversionTemplateDataGrid.selectedItem = SEGModelLocator.getInstance().selectedConversionTemplateVO"	
	>
	
	<mx:Script>
		<![CDATA[
			import com.adobe.cairngorm.control.CairngormEventDispatcher;
			import com.segsoftware.event.SEGEvent;
			import com.segsoftware.control.SEGController;
			import com.segsoftware.model.SEGModelLocator;
			import com.segsoftware.utility.Util;
			
			/**
			 * Displays all ConversionTemplates in the database.
			 */
            private function showAllConversionTemplates():void
            {
            	CairngormEventDispatcher.getInstance().dispatchEvent(new SEGEvent(SEGController.EVENT_GET_ALL_CONVERSION_TEMPLATES, null));
            }		
            
			/**
			* Renders the dialog to enter ConversionJob name.
			*/
			private function showConversionJobDialog():void
			{
				var newConversionJobDialog:NewConversionJobDialog = PopUpManager.createPopUp(this, com.segsoftware.view.conversion.NewConversionJobDialog, true) as NewConversionJobDialog;	
							
				PopUpManager.centerPopUp(newConversionJobDialog);								
			}            		
		]]>
	</mx:Script>
	
	<mx:Model id="formData">
		<formData>
			<sampleConversionData>{sampleConversionData}</sampleConversionData>
		</formData>
	</mx:Model>
	
	<mx:Binding source="conversionDataFileDataGrid.selectedItem as XML" destination="SEGModelLocator.getInstance().selectedConversionDataFileVO"/>	
	<mx:Binding source="conversionTemplateDataGrid.selectedItem as XML" destination="SEGModelLocator.getInstance().selectedConversionTemplateVO"/>
		
	<mx:VBox left="10" right="10" top="10" bottom="10" verticalAlign="bottom">
		<mx:HBox width="100%" height="50%">
			<mx:Panel y="10" height="100%" layout="absolute" left="10" right="10" width="50%" title="Template">
				<mx:DataGrid
					id="conversionTemplateDataGrid" 
					left="0" 
					right="0" 
					top="0" 
					bottom="0"
					dataProvider="{SEGModelLocator.getInstance().conversionTemplateVOs}">
					<mx:columns>
						<mx:DataGridColumn headerText="Name" dataField="TemplateName"/>
						<mx:DataGridColumn headerText="Description" dataField="TemplateDescription"/>
						<mx:DataGridColumn headerText="MaintDateTime" dataField="MaintDateTime"/>					
					</mx:columns>
				</mx:DataGrid>
				<mx:ControlBar horizontalAlign="right">
					<mx:Button 
						id="showAllButton"
						label="Show All" 
						click="showAllConversionTemplates()"/>
				</mx:ControlBar>
			</mx:Panel>	
			<mx:Panel width="50%" height="100%" layout="absolute" title="Conversion Directory">
				<mx:DataGrid
					id="conversionDataFileDataGrid"
					left="0" 
					right="0" 
					top="0" 
					bottom="0"
					dataProvider="{SEGModelLocator.getInstance().conversionDataFileVOs}"
					change=
					"
						Util.dispatchEvent(SEGController.EVENT_LOAD_SAMPLE_CONVERSION_DATA, null);
					">
					<mx:columns>
						<mx:DataGridColumn headerText="File Name" dataField="FileName"/>
						<mx:DataGridColumn headerText="File Size (bytes)" dataField="FileSize"/>
					</mx:columns>
				</mx:DataGrid>
				<mx:ControlBar horizontalAlign="right">
					<mx:Button 
						label="Show All"
						click="Util.dispatchEvent(SEGController.EVENT_GET_ALL_TEST_FILES, null)"/>
				</mx:ControlBar>
			</mx:Panel>
		</mx:HBox>	
		<mx:HBox width="100%" height="50%">
			<mx:Panel width="50%" height="100%" layout="absolute" title="Sample of Pre-Conversion Data">
				<custom:SEGTextArea 
					left="0" 
					right="0" 
					top="0" 
					bottom="0"
					id="sampleConversionData"
					text="{SEGModelLocator.getInstance().sampleConversionData}"/>
			</mx:Panel>
			<mx:Panel width="50%" height="100%" layout="absolute" title="Sample of Post-Conversion Data">
				<custom:SEGTextArea 
					left="0" 
					right="0" 
					top="0" 
					bottom="0"
					id="sampleConvertedData"
					text="{SEGModelLocator.getInstance().sampleConvertedData}"/>
				<mx:ControlBar horizontalAlign="right">
					<mx:Button 
						id="test"
						label="Run Sample Test"
						click="CairngormEventDispatcher.getInstance().dispatchEvent(new SEGEvent(SEGController.EVENT_TEST_CONVERSION_TEMPLATE, formData))"/>
					<mx:VRule height="20"/>
					<mx:Button 
						label="Run Full Conversion"
						click="showConversionJobDialog()"
						/>
				</mx:ControlBar>
			</mx:Panel>
		</mx:HBox>		
	</mx:VBox>
</mx:Canvas>
