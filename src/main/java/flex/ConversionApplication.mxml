<?xml version="1.0" encoding="utf-8"?>
<mx:Application 
	xmlns:mx="http://www.adobe.com/2006/mxml" 
	xmlns:conversion="com.segsoftware.view.conversion.*"	
	layout="absolute" 
	xmlns:control="com.segsoftware.control.*"
	xmlns:business="com.segsoftware.business.*"
	xmlns:custom="com.segsoftware.view.custom.*"
	xmlns:model="com.segsoftware.model.*"
	xmlns:logging="com.segsoftware.model.logging.*"
	initialize="init()" 
	creationComplete="onCreationComplete()"
	width="100%" 
	height="100%" 
	>

	<mx:Style source="com/segsoftware/view/css/segSoftware.css"/>		

	<!-- External script(s) that are used -->
	<mx:Script>
		<![CDATA[
			import com.segsoftware.model.conversion.GroupNode;
			import com.segsoftware.model.SEGModelLocator;
			import com.segsoftware.model.logging.SEGLog;
			import mx.logging.*;
			import mx.events.*;
			import com.segsoftware.model.CodeTable; 
			import com.segsoftware.utility.Util;
			
	
			/**
			 * System bootstrap operations.
			 */
			private function init():void
			{
				// Touch this for pre-loading the DB values...
				var codeTable:CodeTable = CodeTable.getInstance();
				
				// Grab the operator from the enclosing JSP (probably SEGSoftwareApplication.jsp)
				var passedInOperator:String = Util.initString(Application.application.parameters.operator, "N/A");
				
				SEGModelLocator.getInstance().operator = passedInOperator;
				
				// Grab the flag to allow recording of PRASE events or not.
				var passedInAllowPRASERecording:String = Util.initString(Application.application.parameters.allowPRASERecording, "Y");
				
				var allowPRASERecording:Boolean = (passedInAllowPRASERecording == "N")?false:true;
				
				SEGModelLocator.getInstance().allowPRASERecording = allowPRASERecording;
			}	
			
			/**
			* CreationComplete.
			*/
			private function onCreationComplete():void
			{				
				getAllConversionTemplates();
				
				getAllConversionData();	
				
				getAllConversionJobs();			
			}
			
			/**
			 * Gets all ConversionTemplates in the database.
			 */
            private function getAllConversionTemplates():void
            {
            	Util.dispatchEvent(SEGController.EVENT_GET_ALL_CONVERSION_TEMPLATES, null);
            }
            
            /**
            * The listing of all files available to convert.
            */
            private function getAllConversionData():void
            {
				Util.dispatchEvent(SEGController.EVENT_GET_ALL_TEST_FILES);            	
            }	
            
            /**
            *	Gets all ConversionJobs.
            */
            private function getAllConversionJobs():void
            {
				Util.dispatchEvent(SEGController.EVENT_GET_CONVERSION_JOBS);            	            	
            }
		]]>
	</mx:Script>	
		
	<!-- the FrontController, containing Commands specific to this appliation -->
	<control:SEGController id="segController" />

	<!-- Logging mechanism -->
	<logging:SEGLog id="segLog" />
	
	<!-- Services are defined here and are readily accessible throughout the application -->
	<business:Services id="services" />
	
	<!-- Our menu system for our flex pages -->
	<custom:SEGApplicationControlBar dock="true" height="46"/>
		
	<mx:TabNavigator left="10" right="10" top="10" bottom="10">
		<conversion:GroupDesign label="Design Template" width="100%" height="100%"/>
		<conversion:GroupRun label="Run Conversion" width="100%" height="100%"/>		
	</mx:TabNavigator>
</mx:Application>
